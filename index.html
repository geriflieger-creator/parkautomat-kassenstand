<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parkautomat Kassenstand</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        .coin-group {
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 2px solid #000 !important;
        }
        .coin-group:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .header-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .k11-bg {
            background-color: #dbeafe; /* Hellblau */
        }
        .k12-bg {
            background-color: #ede9fe; /* Helllila */
        }
    </style>
</head>
<body>
    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-xl w-full max-w-5xl">
        <div class="header-gradient text-white p-4 rounded-xl mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">Parkautomat Kassenstand</h1>
            <p class="text-blue-100 text-lg">Verwalten Sie die Münzbestände Ihrer Parkautomaten</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- K11 Section mit blauem Hintergrund -->
            <div class="k11-bg p-4 md:p-6 rounded-xl shadow-inner border border-blue-300 h-full">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center underline">K11</h2>
                
                <!-- 50 Cent Münzen (jetzt oben) -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        50 Cent Münzen (<span class="text-red-600 font-bold">Max: 400</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin50ct-k11" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value50ct-k11">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="400" readonly id="refill50ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value50ct-k11">€200,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="400" readonly id="new50ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="new-value50ct-k11">€200,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 100 Stk.</div>
                </div>
                
                <!-- 20 Cent Münzen -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        20 Cent Münzen (<span class="text-red-600 font-bold">Max: 500</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin20ct-k11" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value20ct-k11">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="500" readonly id="refill20ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value20ct-k11">€100,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="500" readonly id="new20ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="new-value20ct-k11">€100,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 100 Stk.</div>
                </div>
                
                <!-- 2 Euro Münzen -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        2 Euro Münzen (<span class="text-red-600 font-bold">Max: 380</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin2euro-k11" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value2euro-k11">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="350" readonly id="refill2euro-k11">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value2euro-k11">€700,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="350" readonly id="new2euro-k11">
                            <div class="text-xs mt-1 text-gray-600" id="new-value2euro-k11">€700,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 50 Stk.</div>
                </div>
                
                <!-- 10 Cent Münzen (jetzt unten) -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        10 Cent Münzen (<span class="text-red-600 font-bold">Max: 770</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin10ct-k11" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value10ct-k11">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="700" readonly id="refill10ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value10ct-k11">€70,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="700" readonly id="new10ct-k11">
                            <div class="text-xs mt-1 text-gray-600" id="new-value10ct-k11">€70,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 100 Stk.</div>
                </div>
            </div>

            <!-- K12 Section mit lila Hintergrund -->
            <div class="k12-bg p-4 md:p-6 rounded-xl shadow-inner border border-purple-300 h-full">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center underline">K12</h2>
                
                <!-- 10 Cent Münzen (jetzt oben) -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        10 Cent Münzen (<span class="text-red-600 font-bold">Max: 1000</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin10ct-k12" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value10ct-k12">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="1000" readonly id="refill10ct-k12">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value10ct-k12">€100,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="1000" readonly id="new10ct-k12">
                            <div class="text-xs mt-1 text-gray-600" id="new-value10ct-k12">€100,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 100 Stk.</div>
                </div>
                
                <!-- 50 Cent Münzen -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        50 Cent Münzen (<span class="text-red-600 font-bold">Max: 500</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin50ct-k12" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value50ct-k12">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="500" readonly id="refill50ct-k12">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value50ct-k12">€250,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="500" readonly id="new50ct-k12">
                            <div class="text-xs mt-1 text-gray-600" id="new-value50ct-k12">€250,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 100 Stk.</div>
                </div>
                
                <!-- 2 Euro Münzen (jetzt unten) -->
                <div class="mb-4 p-3 bg-white rounded-lg coin-group">
                    <label class="block text-gray-700 text-sm font-medium mb-2">
                        2 Euro Münzen (<span class="text-red-600 font-bold">Max: 600</span> Stk.):
                    </label>
                    <div class="grid grid-cols-3 gap-x-2">
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Aktuell:</label>
                            <input type="number" id="coin2euro-k12" class="w-20 px-2 py-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 text-xs text-center" placeholder="Stk." value="0" min="0">
                            <div class="text-xs mt-1 text-gray-600" id="value2euro-k12">€0,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Nachfüllen:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-yellow-100 text-gray-600 font-bold italic focus:outline-none text-xs text-center" value="600" readonly id="refill2euro-k12">
                            <div class="text-xs mt-1 text-gray-600" id="refill-value2euro-k12">€1.200,00</div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-xs mb-1">Neuer Stand:</label>
                            <input type="text" class="w-20 px-2 py-1 border border-gray-300 rounded-lg bg-lime-400 text-gray-800 font-bold focus:outline-none text-xs text-center" value="600" readonly id="new2euro-k12">
                            <div class="text-xs mt-1 text-gray-600" id="new-value2euro-k12">€1.200,00</div>
                        </div>
                    </div>
                    <div class="text-xs text-gray-500 mt-1 text-center">Nachfüllschritt: 50 Stk.</div>
                </div>
            </div>
        </div>

        <!-- Info Section -->
        <div class="mt-6 text-center text-gray-600 text-sm">
            <p>Geben Sie die aktuellen Münzbestände ein, um die Nachfüllmengen zu berechnen</p>
        </div>
    </div>

    <script>
        // Coin values in Euros
        const coinValues = {
            '10ct': 0.10,
            '20ct': 0.20,
            '50ct': 0.50,
            '2euro': 2.00,
        };

        // Max capacities for each machine type
        const maxCapacities = {
            K11: {
                '10ct': 770,
                '20ct': 500,
                '50ct': 400,
                '2euro': 380,
            },
            K12: {
                '10ct': 1000,
                '50ct': 500,
                '2euro': 600,
            },
        };

        // Format number as Euro currency
        function formatEuro(amount) {
            return new Intl.NumberFormat('de-DE', { 
                style: 'currency', 
                currency: 'EUR',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2 
            }).format(amount);
        }

        // Calculate refill value with custom rounding steps
        function getRefillNumericValue(currentCoinAmount, maxCapacityCoin, coinType) {
            if (currentCoinAmount === '') {
                return '';
            }

            const parsedCurrent = parseFloat(currentCoinAmount || 0);

            if (parsedCurrent >= maxCapacityCoin) {
                return 0;
            } else {
                const needed = maxCapacityCoin - parsedCurrent;
                let roundedNeeded;

                // Determine the rounding step based on the coin type
                let roundingStep;
                if (coinType === '2euro') {
                    roundingStep = 50; // 2 Euro in 50er-Schritten
                } else if (coinType === '50ct') {
                    roundingStep = 100; // 50 Cent in 100er-Schritten
                } else {
                    roundingStep = 100; // Alle anderen in 100er-Schritten
                }

                // Calculate the rounded value
                roundedNeeded = Math.round(needed / roundingStep) * roundingStep;

                // If the rounded value is greater than the actual needed amount,
                // we round down to the previous multiple
                if (roundedNeeded > needed && needed > 0) {
                    roundedNeeded = Math.floor(needed / roundingStep) * roundingStep;
                }
                
                // Ensure the result is never negative
                return Math.max(0, roundedNeeded);
            }
        }

        // Update all calculations
        function updateCalculations() {
            // K11 calculations
            const coinsK11 = [
                { id: '50ct', element: document.getElementById('coin50ct-k11'), max: maxCapacities.K11['50ct'] },
                { id: '20ct', element: document.getElementById('coin20ct-k11'), max: maxCapacities.K11['20ct'] },
                { id: '2euro', element: document.getElementById('coin2euro-k11'), max: maxCapacities.K11['2euro'] },
                { id: '10ct', element: document.getElementById('coin10ct-k11'), max: maxCapacities.K11['10ct'] }
            ];

            coinsK11.forEach(coin => {
                const value = coin.element.value;
                const refillValue = getRefillNumericValue(value, coin.max, coin.id);
                const newValue = value === '' ? '' : (parseFloat(value || 0) + parseFloat(refillValue || 0));
                
                // Update refill and new value fields
                document.getElementById(`refill${coin.id}-k11`).value = refillValue;
                document.getElementById(`new${coin.id}-k11`).value = newValue;
                
                // Update Euro values
                const currentValueEuro = value === '' ? 0 : parseFloat(value || 0) * coinValues[coin.id];
                const refillValueEuro = refillValue === '' ? 0 : parseFloat(refillValue || 0) * coinValues[coin.id];
                const newValueEuro = currentValueEuro + refillValueEuro;
                
                document.getElementById(`value${coin.id}-k11`).textContent = formatEuro(currentValueEuro);
                document.getElementById(`refill-value${coin.id}-k11`).textContent = formatEuro(refillValueEuro);
                document.getElementById(`new-value${coin.id}-k11`).textContent = formatEuro(newValueEuro);
            });

            // K12 calculations
            const coinsK12 = [
                { id: '10ct', element: document.getElementById('coin10ct-k12'), max: maxCapacities.K12['10ct'] },
                { id: '50ct', element: document.getElementById('coin50ct-k12'), max: maxCapacities.K12['50ct'] },
                { id: '2euro', element: document.getElementById('coin2euro-k12'), max: maxCapacities.K12['2euro'] }
            ];

            coinsK12.forEach(coin => {
                const value = coin.element.value;
                const refillValue = getRefillNumericValue(value, coin.max, coin.id);
                const newValue = value === '' ? '' : (parseFloat(value || 0) + parseFloat(refillValue || 0));
                
                // Update refill and new value fields
                document.getElementById(`refill${coin.id}-k12`).value = refillValue;
                document.getElementById(`new${coin.id}-k12`).value = newValue;
                
                // Update Euro values
                const currentValueEuro = value === '' ? 0 : parseFloat(value || 0) * coinValues[coin.id];
                const refillValueEuro = refillValue === '' ? 0 : parseFloat(refillValue || 0) * coinValues[coin.id];
                const newValueEuro = currentValueEuro + refillValueEuro;
                
                document.getElementById(`value${coin.id}-k12`).textContent = formatEuro(currentValueEuro);
                document.getElementById(`refill-value${coin.id}-k12`).textContent = formatEuro(refillValueEuro);
                document.getElementById(`new-value${coin.id}-k12`).textContent = formatEuro(newValueEuro);
            });
        }

        // Add event listeners to all input fields
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', updateCalculations);
        });

        // Initialize calculations
        updateCalculations();
    </script>
</body>
</html>
